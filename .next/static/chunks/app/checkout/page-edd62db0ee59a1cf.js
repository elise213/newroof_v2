(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[279],{5170:(e,r,t)=>{Promise.resolve().then(t.bind(t,5259))},5259:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>w});var n,a=t(5155),o=t(2115),s="https://js.stripe.com/v3",c=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,i=function(){for(var e=document.querySelectorAll('script[src^="'.concat(s,'"]')),r=0;r<e.length;r++){var t=e[r];if(c.test(t.src))return t}return null},l=function(e){var r=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",t=document.createElement("script");t.src="".concat(s).concat(r);var n=document.head||document.body;if(!n)throw Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return n.appendChild(t),t},d=function(e,r){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"5.6.0",startTime:r})},u=null,h=null,p=null,m=function(e,r,t){if(null===e)return null;var n=e.apply(void 0,r);return d(n,t),n},f=!1,v=function(){return n||(n=(null!==u?u:(u=new Promise(function(e,r){if("undefined"==typeof window||"undefined"==typeof document){e(null);return}if(window.Stripe,window.Stripe){e(window.Stripe);return}try{var t,n=i();n?n&&null!==p&&null!==h&&(n.removeEventListener("load",p),n.removeEventListener("error",h),null===(t=n.parentNode)||void 0===t||t.removeChild(n),n=l(null)):n=l(null),p=function(){window.Stripe?e(window.Stripe):r(Error("Stripe.js not available"))},h=function(){r(Error("Failed to load Stripe.js"))},n.addEventListener("load",p),n.addEventListener("error",h)}catch(e){r(e);return}})).catch(function(e){return u=null,Promise.reject(e)})).catch(function(e){return n=null,Promise.reject(e)}))};Promise.resolve().then(function(){return v()}).catch(function(e){f||console.warn(e)});var g=t(9627),j=t(717),x=t(7370),S=t(8173),k=t.n(S);let y=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];f=!0;var n=Date.now();return v().then(function(e){return m(e,r,n)})}("pk_live_51Q08RhFOQNBOjDBouLBpSTTaji5QAdkcnanUMxsgy4N9rHEsBYsfU2vRo2kD3RKf06SBZoG3VrxMl4eT0UWeaB1S00n0eGJnBS"),w=()=>{let{store:e,actions:r}=(0,o.useContext)(g.o),[t,n]=(0,o.useState)(0),[s,c]=(0,o.useState)(!1);(0,o.useEffect)(()=>{n(e.cart.reduce((e,r)=>e+r.price,0))},[e.cart]);let i=async()=>{console.log("Starting checkout with cart:",e.cart);let r=await y;if(!r){console.error("Stripe failed to initialize"),alert("Stripe initialization failed. Please try again.");return}try{let t=await fetch("/api/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cart:e.cart})});if(!t.ok){let e=await t.text();throw Error("Backend error: ".concat(e))}let n=await t.json();if(console.log("Backend response:",n),!n.sessionId)throw Error("sessionId not found in the backend response.");let a=await r.redirectToCheckout({sessionId:n.sessionId});a.error&&(console.error("Stripe redirect error:",a.error.message),alert("There was an error with Stripe checkout. Please try again."))}catch(e){console.error("Error during checkout:",e.message),alert("Failed to start checkout. Check the console for details.")}};return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"checkoutPage",children:[(0,a.jsx)(k(),{href:"/",passHref:!0,children:(0,a.jsx)(j.default,{startIcon:(0,a.jsx)(x.default,{}),className:"backButton",children:"Back to Shop"})}),(0,a.jsx)("div",{className:"bill-container",children:e.cart.length>0?(0,a.jsxs)("div",{className:"cartDiv",children:[(0,a.jsx)("ul",{children:e.cart.map((e,t)=>(0,a.jsxs)("li",{children:[(0,a.jsxs)("span",{className:"name-checkout",children:[e.name," Housing Group"]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"price-checkout",children:["$",e.price]}),(0,a.jsx)("button",{className:"remove-cart",onClick:()=>r.removeFromCart(e.id),title:"Remove ".concat(e.name," from your cart"),children:"X"})]})]},t))}),(0,a.jsxs)("div",{className:"total-div",children:[(0,a.jsx)("span",{children:" Billed Annually"}),(0,a.jsxs)("span",{className:"total",children:["Total: $",t]})]}),(0,a.jsxs)("div",{className:"termsDiv",children:[(0,a.jsx)("input",{type:"checkbox",className:"terms_checkbox",checked:s,onChange:()=>c(!s),style:{accentColor:"white"}}),(0,a.jsxs)("span",{className:"terms",children:["To proceed with your purchase, it's important to understand the"," ",(0,a.jsx)(k(),{className:"terms-link",href:"/terms",passHref:!0,children:"rules and terms"})," ","of the group. By checking this box, you are agreeing to these terms."]})]}),s?(0,a.jsx)("button",{className:"addToCart",style:{borderRadius:"4px",margin:"13px 0",alignSelf:"center"},onClick:i,children:"Proceed to Payment"}):(0,a.jsx)("div",{style:{margin:"23px"}})]}):(0,a.jsx)("p",{style:{color:"black"},children:"Your cart is empty."})})]})})}},9627:(e,r,t)=>{"use strict";t.d(r,{o:()=>s,A:()=>c});var n=t(5155),a=t(2115);let o=e=>{let{getStore:r,getActions:t,setStore:n}=e;return{store:{cart:JSON.parse(localStorage.getItem("cart"))||[]},actions:{addToCart:e=>{let t=[...r().cart,e];n({cart:t}),localStorage.setItem("cart",JSON.stringify(t))},removeFromCart:e=>{let t=r().cart.filter(r=>r.id!==e);n({cart:t}),localStorage.setItem("cart",JSON.stringify(t))},clearCart:()=>{n({cart:[]}),localStorage.removeItem("cart")}}}},s=a.createContext(null),c=e=>r=>{let[t,c]=(0,a.useState)(o({getStore:()=>t.store,getActions:()=>t.actions,setStore:e=>c({store:Object.assign(t.store,e),actions:{...t.actions}})}));return(0,n.jsx)(s.Provider,{value:t,children:(0,n.jsx)(e,{...r})})}}},e=>{var r=r=>e(e.s=r);e.O(0,[173,690,441,517,358],()=>r(5170)),_N_E=e.O()}]);