{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/mara/Desktop/projects/homesharing-next/src/app/checkout/page.js"],"sourcesContent":["\"use client\";\n\nimport { useContext, useState, useEffect } from \"react\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { Context } from \"../store/appContext\";\nimport { Avatar, Menu, MenuItem, IconButton, Button } from \"@mui/material\";\nimport ArrowBackIosIcon from \"@mui/icons-material/ArrowBackIos\";\nimport Link from \"next/link\";\n\nconst stripePromise = loadStripe(\n  process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY\n);\n\nconst Checkout = () => {\n  const { store, actions } = useContext(Context);\n  const [totalAmount, setTotalAmount] = useState(0);\n  const [isChecked, setIsChecked] = useState(false);\n\n  useEffect(() => {\n    const total = store.cart.reduce((sum, item) => sum + item.price, 0);\n    setTotalAmount(total);\n  }, [store.cart]);\n\n  const handleCheckout = async () => {\n    console.log(\"Starting checkout with cart:\", store.cart);\n    const stripe = await stripePromise;\n\n    if (!stripe) {\n      console.error(\"Stripe failed to initialize\");\n      alert(\"Stripe initialization failed. Please try again.\");\n      return;\n    }\n\n    try {\n      const response = await fetch(\"/api/checkout\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ cart: store.cart }),\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        throw new Error(`Backend error: ${errorText}`);\n      }\n\n      const data = await response.json();\n      console.log(\"Backend response:\", data);\n\n      if (!data.sessionId) {\n        throw new Error(\"sessionId not found in the backend response.\");\n      }\n\n      const result = await stripe.redirectToCheckout({\n        sessionId: data.sessionId,\n      });\n\n      if (result.error) {\n        console.error(\"Stripe redirect error:\", result.error.message);\n        alert(\"There was an error with Stripe checkout. Please try again.\");\n      }\n    } catch (error) {\n      console.error(\"Error during checkout:\", error.message);\n      alert(\"Failed to start checkout. Check the console for details.\");\n    }\n  };\n\n  return (\n    <>\n      <div className=\"checkoutPage\">\n        <Link href=\"/\" passHref>\n          <Button startIcon={<ArrowBackIosIcon />} className=\"backButton\">\n            Back to Shop\n          </Button>\n        </Link>\n        <div className=\"bill-container\">\n          {store.cart.length > 0 ? (\n            <div className=\"cartDiv\">\n              <ul>\n                {store.cart.map((item, index) => (\n                  <li key={index}>\n                    <span className=\"name-checkout\">\n                      {item.name} Housing Group\n                    </span>\n                    <div>\n                      <span className=\"price-checkout\">${item.price}</span>\n                      <button\n                        className=\"remove-cart\"\n                        onClick={() => actions.removeFromCart(item.id)}\n                        title={`Remove ${item.name} from your cart`}\n                      >\n                        X\n                      </button>\n                    </div>\n                  </li>\n                ))}\n              </ul>\n\n              <div className=\"total-div\">\n                <span> Billed Annually</span>\n                <span className=\"total\">Total: ${totalAmount}</span>\n              </div>\n\n              {/* Terms Agreement */}\n              <div className=\"termsDiv\">\n                <input\n                  type=\"checkbox\"\n                  className=\"terms_checkbox\"\n                  checked={isChecked}\n                  onChange={() => setIsChecked(!isChecked)}\n                  style={{ accentColor: \"white\" }}\n                />\n                <span className=\"terms\">\n                  To proceed with your purchase, it's important to understand\n                  the{\" \"}\n                  <Link className=\"terms-link\" href=\"/terms\" passHref>\n                    rules and terms\n                  </Link>{\" \"}\n                  of the group. By checking this box, you are agreeing to these\n                  terms.\n                </span>\n              </div>\n\n              {isChecked ? (\n                <button\n                  className=\"addToCart\"\n                  style={{\n                    borderRadius: \"4px\",\n                    margin: \"13px 0\",\n                    alignSelf: \"center\",\n                  }}\n                  onClick={handleCheckout}\n                >\n                  Proceed to Payment\n                </button>\n              ) : (\n                <div style={{ margin: \"23px\" }}></div>\n              )}\n            </div>\n          ) : (\n            <p style={{ color: \"black\" }}>Your cart is empty.</p>\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default Checkout;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 297, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}